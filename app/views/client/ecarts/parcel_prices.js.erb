// set delivery time label
$("#delivery-time").text("( <%= @parcel.delivery_time %> )");

// set prices and max weight
var max_weight = new Array();
var parcel_prices = new Array();

<% @prices.each do |price| %>
  parcel_prices.push(<%= price.price %>);
  max_weight.push(<%= price.max_weight %>);
<% end %>

wholesale = parseFloat($("#wholesale").text());
prev_total = $("#order-grand-total").text();
prev_total = parseFloat(prev_total);

found = false;
// calculate total including shipping cost
if(prev_total >= wholesale){
  found = true;
  $("#order-shipping-cost").text(money_format("0.00"));
  $("#shipping_cost_is_present").text("NO");
  console.log("BIG SALE! skipping shipping_cost");
}

max_weight.forEach(function(value, index, array) {
  console.log("iterating to find correct price");
  console.log(value + " " + index + " ");
  if(value > <%= session[:e_cart]["total_weight"] %> && !found){
    console.log("here! " + value + " " + index);
    // set shipping price
    $("#order-shipping-cost").text(money_format(parcel_prices[index].toString()));
    $("#shipping_cost_is_present").text("YES");

    new_total = prev_total + parcel_prices[index];

    // replace total
    $("#order-grand-total").text(money_format(new_total.toString()));
    found = true;
  }

});
